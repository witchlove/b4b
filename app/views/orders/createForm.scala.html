@(orderForm: Form[Order])

@implicitFieldConstructor = @{ FieldConstructor(twitterBootstrapInput.f) }

@import helper._
@import helper.twitterBootstrap._

@informationGroup(field: Field, className: String = "profile") = {
    <div class="twipsies well @className">
        @select(
                field("productId"), 
                options = Product.allForSelect,
                '_default -> "--- Choose a Product ---",
                '_label -> "Products"
            )

        @inputText(
            field("quantity"), 
            '_label -> "quantity"
        )
    </div>
}


@main {
    
    <h1>Create or Edit Product</h1>
    
    @form(routes.OrderController.save()) {
        
    	@if(orderForm.hasGlobalErrors) { 
            <div class="alert alert-error">
                @orderForm.errorsAsJson
            </div>
        }
    	
    	@if(orderForm.hasErrors) { 
            <div class="alert alert-error">
                @orderForm.errorsAsJson
            </div>
        }
    	
        <fieldset>
        	@inputText(orderForm("orderCode"), '_label -> "Order Code")
            @select(
                orderForm("salesPersonId"), 
                options = SalesPerson.allForSelect,
                '_default -> "--- Choose a SalesPerson ---",
                '_label -> "Sales Persons",
                '_error -> orderForm("salespersonId").error.map(_.withMessage("Please select a person"))
            )
        </fieldset>
        
    	<fieldset>
            <legend>OrderItems</legend>
            
            <div id="orderitems">
            
                @repeat(orderForm("orderitems"), min = 2) { orderitem =>
                
                   @informationGroup(orderitem)
                
                }
                
                @informationGroup(
                    orderForm("informations[x]"),
                    className = "profile_template"
                )   

                <div class="manage">
                    <a class="addProfile btn success">Add Order Item</a>
                </div>
          </div>
            
        </fieldset>
    	
        <div class="actions">
            <input type="submit" value="Save Order" class="btn primary"> or 
            <a href="@routes.OrderController.list()" class="btn">Cancel</a>
        </div>
        
    }

      <script type="text/javascript" charset="utf-8">
        $('.addProfile').live('click', function(e) {
        	alert('does thtis click trigger')
            var template = $('.profile_template')
            template.before('<div class="twipsies well profile">' + template.html() + '</div>')
        })
    </script>
    
}